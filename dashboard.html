<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng B√°o C√°o TVBH</title>
    
    <link rel="stylesheet" href="style.css">
    
  </head>
  <body>
    
    <header class="top-bar">
      <div class="top-bar-logo">
        ERP SYSTEM
      </div>
      <div class="user-info">
        <span id="username-display">...</span>
        <button id="logout-button">ƒêƒÉng xu·∫•t</button>
      </div>
    </header>

    <nav class="tab-nav">
      <button class="tab-button" onclick="showTab('entry')">‚úçÔ∏è Nh·∫≠p B√°o C√°o</button>
      <button class="tab-button active" onclick="showTab('daily')">üìä B√°o C√°o Ng√†y</button>
      <button class="tab-button" onclick="showTab('mtd_total')">üìà MTD - T·ªïng</button>
      <button class="tab-button" onclick="showTab('mtd_detail')">üöó MTD - Chi ti·∫øt Xe</button>
    </nav>

    <main class="content-area">
      
      <div id="entry" class="tab-content">
        <div class="card card-form">
          <form id="entry-form" onsubmit="handleFormSubmit(event)">
            <h2 id="entry-title">B√°o C√°o Trong Ng√†y</h2>
            <p class="subtitle">
              Ch·ªçn nh√≥m v√† t√™n c·ªßa b·∫°n ƒë·ªÉ nh·∫≠p ho·∫∑c c·∫≠p nh·∫≠t b√°o c√°o h√¥m nay.
            </p>
            
            <div class="form-group">
              <label for="group">Ch·ªçn Nh√≥m</label>
              <select id="group" name="group" required onchange="populateTvbhEntryList(this.value)">
                <option value="">ƒêang t·∫£i danh s√°ch nh√≥m...</option>
              </select>
            </div>

            <div class="form-group">
              <label for="tvbh">Ch·ªçn TVBH</label>
              <select id="tvbh" name="tvbh" required onchange="loadDailyData(this.value)" disabled>
                <option value="">-- Vui l√≤ng ch·ªçn nh√≥m tr∆∞·ªõc --</option>
              </select>
            </div>

            <div id="form-fields" style="display:none;">
              <div id="form-data-status">Vui l√≤ng ch·ªçn t√™n c·ªßa b·∫°n...</div>
              <hr style="border:0; border-top: 1px solid var(--border-color); margin: 25px 0;">
              <div class="form-group">
                <label for="khtn" style="font-size: 1.1em; font-weight: 700; color: var(--text-color);">T·ªïng Kh√°ch H√†ng Ti·ªÅm NƒÉng (KHTN)</label>
                <input type="number" id="khtn" name="khtn" required min="0" value="0">
              </div>
              <hr style="border:0; border-top: 1px solid var(--border-color); margin: 25px 0;">
              <div id="car-model-inputs">
                <p class="loading-placeholder">ƒêang t·∫£i danh s√°ch d√≤ng xe...</p>
              </div>
              <button type="submit" id="submitButton" class="form-button">L∆∞u B√°o C√°o</button>
              <div id="form-status"></div>
            </div>
          </form>
        </div>
      </div>

      <div id="daily" class="tab-content active">
        <div class="card">
          <h2>B√°o C√°o Ng√†y (T·ªïng h·ª£p)</h2>
          <p class="subtitle">
            M·∫∑c ƒë·ªãnh hi·ªÉn th·ªã ng√†y h√¥m nay. Ch·ªçn ng√†y ƒë·ªÉ xem l·∫°i.
          </p>

          <div class="filter-bar daily-filter-bar">
            <div class="filter-group">
              <label for="daily-date-picker">Ch·ªçn ng√†y</label>
              <input type="date" id="daily-date-picker">
            </div>
            <div class="filter-buttons">
              <button id="daily-filter-btn" class="filter-button" onclick="loadDailyReportByDate()">Xem</button>
            </div>
          </div>
          
          <div id="daily-report-container" class="table-container">
            <div id="loading-daily" class="loading-placeholder">ƒêang t·∫£i d·ªØ li·ªáu...</div>
          </div>
        </div>
      </div>

      <div id="mtd_total" class="tab-content">
        <div class="card">
          <h2>B√°o C√°o MTD (T·ªïng h·ª£p)</h2>
          <p class="subtitle">
            S·ªë li·ªáu t·ªïng h·ª£p t√≠nh t·ª´ ƒë·∫ßu th√°ng ƒë·∫øn hi·ªán t·∫°i, x·∫øp h·∫°ng theo doanh thu.
          </p>
          <div id="mtd-total-report-container" class="table-container">
            <div id="loading-mtd-total" class="loading-placeholder">ƒêang t·∫£i d·ªØ li·ªáu...</div>
          </div>
        </div>
      </div>

      <div id="mtd_detail" class="tab-content">
        <div class="card">
          <h2>B√°o C√°o MTD (Chi ti·∫øt D√≤ng Xe)</h2>
          <p class="subtitle">
            Chi ti·∫øt MTD theo TVBH (h√†ng) v√† D√≤ng Xe (c·ªôt).
          </p>

          <div class="filter-bar">
            <div class="filter-group">
              <label for="filter-group">L·ªçc theo Nh√≥m</label>
              <select id="filter-group" onchange="populateTvbhFilter(this.value)">
                <option value="">T·∫•t c·∫£ c√°c Nh√≥m</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-tvbh">L·ªçc theo TVBH</label>
              <select id="filter-tvbh">
                <option value="">T·∫•t c·∫£ TVBH</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-car-model">L·ªçc theo D√≤ng Xe</label>
              <select id="filter-car-model">
                <option value="">T·∫•t c·∫£ D√≤ng Xe</option>
              </select>
            </div>
            <div class="filter-buttons">
              <button id="filter-btn" class="filter-button" onclick="applyFilters()">L·ªçc</button>
              <button id="reset-btn" class="reset-button" onclick="resetFilters()">X√≥a L·ªçc</button>
              <button id="export-btn" class="export-button" onclick="exportToExcel()">Excel</button>
            </div>
          </div>
          
          <div id="export-status"></div>
          
          <div id="mtd-detail-report-container" class="table-container">
            <div id="loading-mtd-detail" class="loading-placeholder">ƒêang t·∫£i d·ªØ li·ªáu...</div>
          </div>
        </div>
      </div>
    
    </main> <script src="dashboard.js"></script>
    
  </body>
</html>
