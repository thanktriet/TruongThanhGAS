<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=1024" />
  <title>VINFAST TR∆Ø∆†NG TH√ÄNH KI√äN GIANG - LINK HUB</title>

  <style>
    /* --- Import Google Font --- */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    .script-embed-error {
      display: none !important;
      visibility: hidden !important;
    }

    /* --- Bi·∫øn m√†u (Ch·∫ø ƒë·ªô S√ÅNG m·∫∑c ƒë·ªãnh) --- */
    :root {
      --accent: #0ea5a4;
      --accent-light: #f0fdfa; 
      --bg: #f8fafc; 
      --card: #ffffff;
      --border: #e2e8f0;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --radius: 8px;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      
      /* Th·ªùi gian chuy·ªÉn ƒë·ªông cho Dark Mode */
      --theme-transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, Segoe UI, Roboto, 'Helvetica Neue', Arial;
      background: var(--bg);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: var(--theme-transition);
    }

    .wrap { display: flex; min-height: 100vh; }
    
    /* --- Sidebar --- */
    .sidebar {
      width: 320px;
      background: var(--card);
      border-right: 1px solid var(--border);
      padding: 24px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      transition: var(--theme-transition);
    }

    .brand {
      font-weight: 700;
      font-size: 20px;
      margin-bottom: 20px;
      background: linear-gradient(45deg, var(--accent), #0d9488);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .search { display: flex; gap: 8px; margin-bottom: 12px; }

    .search input {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      transition: all 0.2s ease;
      background: var(--bg);
      color: var(--text-primary);
    }
    .search input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(14, 165, 164, 0.15);
    }

    /* --- Danh s√°ch Links --- */
    .list { overflow: auto; flex: 1; padding-right: 8px; margin-top: 8px; }
    
    .list::-webkit-scrollbar { width: 6px; }
    .list::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 10px; }
    .list::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    .list::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

    .item {
      padding: 12px 16px;
      border-radius: var(--radius);
      margin-bottom: 8px;
      background: var(--card);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.2s ease-in-out, var(--theme-transition);
      border-left: 4px solid transparent; /* Chu·∫©n b·ªã cho active state */
    }

    .item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--accent);
    }
    
    /* TR·∫†NG TH√ÅI ACTIVE */
    .item.active {
      background: var(--accent-light);
      border-left: 4px solid var(--accent);
      border-color: var(--accent);
    }

    .item .title { font-weight: 600; font-size: 15px; color: var(--text-primary); transition: var(--theme-transition); }
    .item .desc { font-size: 13px; color: var(--text-secondary); margin-top: 4px; transition: var(--theme-transition); }
    .tags { margin-top: 8px; font-size: 12px; color: #64748b; }
    
    /* --- Khu v·ª±c Main Content --- */
    .main {
      flex: 1;
      padding: 24px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }

    .controls { display: flex; align-items: center; gap: 8px; margin-bottom: 16px; }
    #currentTitle { font-weight: 700; font-size: 1.1rem; color: var(--text-primary); transition: var(--theme-transition); }

    .frameWrap {
      flex: 1;
      border-radius: var(--radius);
      overflow: hidden;
      background: var(--card); /* ƒê·ªïi t·ª´ white sang var(card) */
      border: 1px solid var(--border);
      position: relative;
      box-shadow: var(--shadow-md);
      transition: var(--theme-transition);
    }

    /* Iframe cho mobile */
    iframe { 
      width: 100%; 
      height: 100%; 
      border: 0; 
      overflow: auto; 
      -webkit-overflow-scrolling: touch; /* Gi√∫p cu·ªôn m∆∞·ª£t tr√™n iOS */
    }
    
    /* ICON LOADING XOAY */
    .loader {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 40px;
      height: 40px;
      margin: -20px 0 0 -20px;
      border: 4px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      z-index: 10;
      display: none; /* M·∫∑c ƒë·ªãnh ·∫©n */
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* --- N√∫t b·∫•m (Buttons) --- */
    .btn {
      padding: 9px 16px;
      border-radius: var(--radius);
      background: var(--accent);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    .btn:hover {
      opacity: 0.85;
      box-shadow: 0 4px 12px rgba(14, 165, 164, 0.2);
    }
    .btn.ghost {
      background: transparent;
      color: var(--accent);
      border: 1px solid var(--accent);
    }
    .btn.ghost:hover { background: var(--accent-light); opacity: 1; box-shadow: none; }

    /* --- Overlay --- */
    .overlay {
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      text-align: center;
      gap: 12px;
      border-radius: var(--radius);
    }

    .small { font-size: 13px; color: var(--text-secondary); }
    .footer {
      font-size: 12px;
      color: #94a3b8;
      margin-top: 12px;
      border-top: 1px solid var(--border);
      padding-top: 12px;
      transition: var(--theme-transition);
    }
    
    /* --- TO√ÄN B·ªò CH·∫æ ƒê·ªò T·ªêI (DARK MODE) --- */
    [data-theme="dark"] {
      --accent: #2dd4bf; /* Teal s√°ng h∆°n cho d·ªÖ ƒë·ªçc */
      --accent-light: #115e59; /* Teal t·ªëi ƒë·∫≠m */
      --bg: #0f172a; /* N·ªÅn (Slate 900) */
      --card: #1e293b; /* N·ªÅn th·∫ª (Slate 800) */
      --border: #334155; /* Vi·ªÅn (Slate 700) */
      --text-primary: #f1f5f9; /* Ch·ªØ ch√≠nh (Slate 100) */
      --text-secondary: #94a3b8; /* Ch·ªØ ph·ª• (Slate 400) */
    }
    
    /* Tinh ch·ªânh ri√™ng cho Dark Mode */
    [data-theme="dark"] .brand {
      background: linear-gradient(45deg, var(--accent), #5eead4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    [data-theme="dark"] .btn.ghost:hover {
      background: #115e59; /* M√†u n·ªÅn hover c·ªßa n√∫t ghost */
    }
    [data-theme="dark"] .overlay {
       background: rgba(15, 23, 42, 0.95); /* N·ªÅn overlay t·ªëi */
    }
    [data-theme="dark"] .list::-webkit-scrollbar-track {
      background: #1e293b;
    }
    [data-theme="dark"] .list::-webkit-scrollbar-thumb {
      background: #475569;
    }
    [data-theme="dark"] .list::-webkit-scrollbar-thumb:hover {
      background: #64748b;
    }
    
    /* --- Responsive cho Mobile --- */
    /* (Code n√†y v·∫´n ·ªü ƒë√¢y, nh∆∞ng s·∫Ω kh√¥ng ƒë∆∞·ª£c k√≠ch ho·∫°t tr√™n ƒëi·ªán tho·∫°i n·ªØa
       v√¨ ch√∫ng ta ƒë√£ ƒë·∫∑t width=1024) */
    @media (max-width: 800px) {
      .wrap { 
        flex-direction: column; 
      }
      .sidebar { 
        width: 100%; 
        order: 2; /* ƒê∆∞a sidebar xu·ªëng d∆∞·ªõi */
        border-right: none; 
        border-top: 1px solid var(--border); 
        padding: 12px; 
        max-height: 35vh; 
      }
      .main { 
        order: 1; /* ƒê∆∞a main l√™n tr√™n */
        padding: 12px; 
        min-height: 65vh; 
      }
      
      .brand { 
        margin-bottom: 12px; 
        font-size: 18px; 
      }
      
      .controls {
        margin-bottom: 12px; 
      }
      
      #currentTitle {
        font-size: 1rem; 
      }
      
      .item .title {
        font-size: 14px; 
      }
      
      .item .desc {
        font-size: 12px; 
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="sidebar">
      <div class="brand">VINFAST TR∆Ø∆†NG TH√ÄNH KI√äN GIANG - LINK HUB</div>
      <div class="search">
        <input id="q" placeholder="T√¨m app theo t√™n ho·∫∑c tag..." oninput="filterList()" />
        <button class="btn ghost" onclick="clearSearch()">Clear</button>
        <button class="btn ghost" id="themeToggle" style="width: 42px;">üåô</button>
      </div>
      <div class="tags small" id="tags">T·∫•t c·∫£</div>
      <div class="list" id="linksList"></div>
      <div class="footer">Ghi ch√∫: n·∫øu trang kh√¥ng hi·ªÉn th·ªã trong iframe, ƒë√≥ c√≥ th·ªÉ do trang ƒë√≥ ch·∫∑n embed (X-Frame-Options). B·∫°n c√≥ th·ªÉ m·ªü trong c√πng tab b·∫±ng n√∫t trong overlay.</div>
    </div>

    <div class="main">
      <div class="controls">
        <div id="currentTitle" style="font-weight:700">ƒêang m·ªü app...</div>
        <div style="flex:1"></div>
        <button class="btn" onclick="openInSameTab()">M·ªü trong tab n√†y</button>
      </div>

      <div class="frameWrap" id="frameWrap">
        <div class="loader" id="loader"></div>
        
        <iframe id="viewer" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>

        <div class="overlay" id="overlay" style="display:none">
          <div style="font-weight:700">Kh√¥ng th·ªÉ hi·ªÉn th·ªã n·ªôi dung ·ªü ƒë√¢y</div>
          <div class="small">Trang n√†y c√≥ th·ªÉ ch·∫∑n vi·ªác nh√∫ng (X-Frame-Options or CSP). B·∫°n c√≥ th·ªÉ m·ªü trang trong c√πng tab.</div>
          <div style="display:flex;gap:8px">
            <button class="btn" id="openSameBtn">M·ªü trong tab n√†y</button>
            <button class="btn ghost" onclick="closeOverlay()">ƒê√≥ng overlay</button>
          </div>
        </div>
      </div>

      <div style="margin-top:8px;font-size:13px;color:#475569">
        L∆∞u √Ω: link m·∫∑c ƒë·ªãnh m·ªü trong iframe. N·∫øu b·∫°n mu·ªën m·ªü trang l·ªõn b·∫•m v√†o "m·ªü trong tab n√†y" g√≥c ph·∫£i ·ªü tr√™n m√†n h√¨nh.
      </div>
    </div>
  </div>
  
  <script>
    const LINKS = [
      {id:'app0', title:'B√°o c√°o ng√†y', url:'https://script.google.com/macros/s/AKfycbysNXY9mB-1cesOKXzfh-r0QLD0xmdbQyxropMK7LJsCzcH6JG4Hg_MolDoIshzrobGSA/exec', desc:'B√°o c√°o ng√†y', tag:'B√°o c√°o ng√†y'},
      {id:'app1', title:'Dashboard Doanh S·ªë', url:'https://script.google.com/macros/s/AKfycbzgIUo156Jz_nawrRIkeig25Nenk7oOzgjxYOrEuumD0Yqi3CZjw8EY3ml7tKWsB_Eg/exec', desc:'B·∫£ng theo d·ªèi doanh s·ªë', tag:'doanh s·ªë'},
      {id:'app2', title:'Th√¥ng tin ƒë∆°n h√†ng', url:'https://script.google.com/macros/s/AKfycbyTCSHuQWb_BgyVk8QqqkrIlz7J44kanIIX0X6AiRVDXkqQCo9FZKqI_Ltk5BwqPPjM/exec',desc:'Th√¥ng tin ƒë∆°n h√†ng', tag:'thongtindonhang'},
      {id:'app3', title:'Nh·∫≠p tho·∫£ thu·∫≠n h·ªï tr·ª£ LS', url:'https://script.google.com/macros/s/AKfycbyGvXnX2FOXvu5LXvgnnmh0pkLGdmTlBJU8jWkrZ0uFecgJD0GTV8nkuc_ehoG4gXMvVA/exec', desc:'Nh·∫≠p tho·∫£ thu·∫≠n h·ªï tr·ª£ LS', tag:'TTLS'},
      {id:'app4', title:'Kho xe', url:'https://script.google.com/macros/s/AKfycbwAcUcDhf2zngEoKxTgk-cTCtCeZ_X7AeW-n4EaUV5gpuZPa0oFNgKRu7OousX8Dcx4sg/exec?pli=1', desc:'Kho xe y√™u c·∫ßu ƒëƒÉng nh·∫≠p', tag:'khoxe'},
      {id:'app5', title:'T√¨m xe', url:'https://script.google.com/macros/s/AKfycbzGJ0HtbV_h0GqB95N4gg9u2Jl4hmX6Lt4S40U9DzYGAauMzhAlKVCw_aoALtynG1xl/exec', desc:'T√¨m xe trong kho', tag:'timxe'},
      {id:'app6', title:'Ch√≠nh s√°ch', url:'https://script.google.com/macros/s/AKfycbwTE2s8GZq5N5mjlSN5Uo-l1GdtM0PZX6RDl6SxBI-g-N_h53rzqhxKs2cQceFyu9rO/exec', desc:'Ch√≠nh s√°ch VinFast', tag:'chinhsach'},
      {id:'app7', title:'T√≠nh l√£i vay', url:'https://script.google.com/macros/s/AKfycbwOob8NhBYkgTg0zdBnJCyI6iWWTT0Abh7TQewQn2aixY-povZ10UVv9qGc7dFOG1G1/exec', desc:'T√≠nh l√£i vay', tag:'tinhlaivay'},
    ];

    let filtered = LINKS.slice();
    const listEl = document.getElementById('linksList');
    const viewer = document.getElementById('viewer');
    const overlay = document.getElementById('overlay');
    const currentTitle = document.getElementById('currentTitle');
    const loader = document.getElementById('loader'); 
    const themeToggle = document.getElementById('themeToggle'); 
    let currentUrl = null;

    function renderList(){
      listEl.innerHTML = '';
      if(filtered.length === 0){
        listEl.innerHTML = '<div style="color:var(--text-secondary);padding:8px">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£</div>';
        return;
      }
      
      filtered.forEach(item=>{
        const it = document.createElement('div');
        it.className = 'item';
        it.dataset.id = item.id; // Th√™m ID ƒë·ªÉ qu·∫£n l√Ω active
        it.innerHTML = `<div class="title">${escapeHtml(item.title)}</div>
                        <div class="desc">${escapeHtml(item.desc || '')}</div>
                        <div class="tags small">${escapeHtml(item.tag || '')}</div>`;
        it.onclick = ()=> openLink(item);
        listEl.appendChild(it);
      });
    }

    function filterList(){
      const q = (document.getElementById('q').value || '').toLowerCase().trim();
      filtered = LINKS.filter(l=>{
        return l.title.toLowerCase().includes(q) || (l.tag||'').toLowerCase().includes(q) || (l.desc||'').toLowerCase().includes(q);
      });
      document.getElementById('tags').innerText = q ? `K·∫øt qu·∫£ cho "${q}"` : 'T·∫•t c·∫£';
      renderList();
    }

    function openLink(item){
      currentUrl = item.url;
      currentTitle.innerText = item.title;
      overlay.style.display = 'none';
      loader.style.display = 'block'; // Hi·ªÉn th·ªã loader

      // Qu·∫£n l√Ω tr·∫°ng th√°i Active
      document.querySelectorAll('.item.active').forEach(activeItem => {
        activeItem.classList.remove('active');
      });
      const currentItemEl = document.querySelector(`.item[data-id="${item.id}"]`);
      if (currentItemEl) {
        currentItemEl.classList.add('active');
      }

      // T·∫£i iframe v√† theo d·ªèi
      viewer.src = item.url;
      
      // T·∫Øt loader khi iframe t·∫£i xong (cho c·∫£ tr∆∞·ªùng h·ª£p th√†nh c√¥ng v√† b·ªã ch·∫∑n)
      viewer.onload = () => {
        loader.style.display = 'none';
      };
      
      // Logic c≈© ƒë·ªÉ ph√°t hi·ªán X-Frame-Options (v·∫´n c·∫ßn thi·∫øt)
      setTimeout(()=> {
        try {
          const doc = viewer.contentDocument || viewer.contentWindow.document;
          if(!doc || doc.location.href === 'about:blank'){
            loader.style.display = 'none'; // ·∫®n loader
            showBlockedOverlay(item);
          } else {
            loader.style.display = 'none'; // ·∫®n loader
            overlay.style.display = 'none';
          }
        } catch(e){
          setTimeout(()=>{
            const r = viewer.getBoundingClientRect();
            if(r.width < 100 || r.height < 50){
              loader.style.display = 'none'; // ·∫®n loader
              showBlockedOverlay(item);
            } else {
              loader.style.display = 'none'; // ·∫®n loader
              overlay.style.display = 'none';
            }
          },1200);
        }
      },700);
    }

    function showBlockedOverlay(item){
      overlay.style.display = 'flex';
      document.getElementById('openSameBtn').onclick = ()=> {
        window.location.href = item.url;
      };
    }

    function openInSameTab(){
      if(currentUrl) window.location.href = currentUrl;
      else alert('Ch∆∞a c√≥ app n√†o ƒë∆∞·ª£c ch·ªçn.');
    }
    function closeOverlay(){ overlay.style.display = 'none'; }
    function clearSearch(){ document.getElementById('q').value=''; filterList(); }
    function escapeHtml(str){ return (str||'').replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    // --- QU·∫¢N L√ù DARK MODE ---

    // 1. H√†m b·∫≠t/t·∫Øt theme
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme); // L∆∞u v√†o b·ªô nh·ªõ
      
      // ƒê·ªïi icon
      themeToggle.innerText = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    }

    // 2. H√†m setup theme khi t·∫£i trang
    function setupTheme() {
      // L·∫•y theme ƒë√£ l∆∞u, n·∫øu kh√¥ng c√≥ th√¨ m·∫∑c ƒë·ªãnh l√† 'light'
      const savedTheme = localStorage.getItem('theme') || 'light'; 
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      // C·∫≠p nh·∫≠t icon cho ƒë√∫ng
      themeToggle.innerText = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      
      // G√°n s·ª± ki·ªán click cho n√∫t
      themeToggle.addEventListener('click', toggleTheme);
    }

    // --- KH·ªûI ƒê·ªòNG ·ª®NG D·ª§NG ---
    window.addEventListener('DOMContentLoaded',()=>{
      setupTheme(); // C√†i ƒë·∫∑t theme tr∆∞·ªõc
      filtered = LINKS.slice();
      renderList();
      // Lu√¥n m·ªü app ƒë·∫ßu ti√™n
      if(LINKS.length > 0){
        openLink(LINKS[0]);
      }
    });
  </script>
</body>
</html>
